<div style=" display: flex; flex-direction: column; justify-content: space-between; height: 100%" *ngIf="authorized; else unauthorized">
  <div style="width:100%; display: flex; justify-content: center" class="mat-app-background">
    <div style="padding: 20px" *ngIf="session && session.sessionName">
      <h3>{{session.sessionName}}</h3>
    </div>
  </div>
  <div class="content" *ngIf="authorized; else unauthorized">

    <div class="tiles">
      <user-tiles>
        <user-tile cdkDrag *ngFor="let participant of session.participants | participantFilter"
                   [participant]="participant"
                   [locked]="session.sessionId == 311"
                   [sessionId]="session.sessionId" [pointsVisible]="session.pointsVisible" [isDarkTheme]="isDarkTheme"
                   [myCard]="isMyCard(participant)">
        </user-tile>
      </user-tiles>

    </div>

  </div>

  <div class="toolbar mat-app-background" style="height:130px">

    <control-panel
      (participantJoined)="joinSession($event)"
      (participantLeft)="leaveSession($event)"
      (pointVisibilityEvent)="changePointVisibility($event)"
      (voteSubmitted)="voteHasChanged($event)"
      [sessionId]="session.sessionId"
      [participant]="participant"
      [locked]="session.sessionId == 311"
      [logs]="logs"
      [showLogs]="false"
    >
    </control-panel>
  </div>
</div>

<!--extract auth-->

<ng-template #unauthorized>
  <div style="width:100%; height:100%; display: flex; justify-content: center; align-items: center" class="mat-app-background">
    <mat-card>
      <mat-card-title>
        This session requires a passcode to enter
      </mat-card-title>

      <mat-card-subtitle>
        <div *ngIf="queryParams() | async as qp">
            {{errors[qp['error']]}}
        </div>
      </mat-card-subtitle>

      <mat-card-content>
        <div style="display: flex; flex-direction: row; align-items: center; justify-content: space-evenly;">
          <div>
        <mat-form-field  appearance="fill">
          <mat-label>Input</mat-label>
          <input [(ngModel)]="passcode"  type="password" matInput>
        </mat-form-field>
          </div>
          <div>
        <button (click)="enterPasscodeForSession() "mat-raised-button color="primary">Submit</button>
          </div>
        </div>
      </mat-card-content>
    </mat-card>
  </div>

</ng-template>
